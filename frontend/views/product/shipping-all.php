<?php use appxq\sdii\helpers\SDHtml;use appxq\sdii\helpers\SDNoty;use appxq\sdii\widgets\ModalForm;use yii\bootstrap\ActiveForm;use yii\helpers\Html;?><div class="text-right">    <button class="btn btn-success btn-shipping-create">เพิ่มที่อยู่ใหม่</button></div><?phpif($model):?>    <?php $form = ActiveForm::begin([        'id'=>$model->formName(),    ]); ?>    <?php        $model->default = $model->id;    ?>            <?php                $shipping = \backend\modules\products\models\Shippings::find()                    ->where('create_by=:user_id AND rstat not in(0,3)',[                        ':user_id' => \common\modules\user\classes\CNUserFunc::getUserId()                    ])->all();            ?>            <?php if($shipping):?>                <?php foreach($shipping as $k=>$v):?>                        <div class="radio">                            <label>                                <input                                        class="radio-address"                                        type="radio"                                        name="default"                                        value="<?= $v->id; ?>"                                        <?= $v->id == $model->id?'checked':'' ?>                                         > <?= isset($v->address)?$v->address:'';?>                                        <a href="<?= \yii\helpers\Url::to(['/product/shipping-create?id='.$v->id])?>" class="btn btn-xs btn-info btn-shipping-update">                                            <i class="glyphicon glyphicon-pencil"></i>                                        </a>                                        <a data-id="<?= $v->id;?>" href="<?= \yii\helpers\Url::to(['/product/shipping-delete'])?>" class="btn btn-xs btn-danger btn-shipping-delete">                                            <i class="glyphicon glyphicon-trash"></i>                                        </a>                            </label>                        </div>                <?php endforeach; ?>            <?php endif; ?>            <?= Html::submitButton('ยืนยัน', ['class' => 'btn btn-warning btn-submit-update']) ?>            <button class="btn btn-default btn-cancel" type="button">ยกเลิก</button>    <?php ActiveForm::end(); ?><?php endif;?><?=  ModalForm::widget([    'id' => 'modal-shippings',    //'size'=>'modal-lg',]);?><?php  \richardfan\widget\JSRegister::begin(); ?><script>    $(".btn-submit-update").on('click', function(){        let id =  $("input[name='default']:checked").val()        let url = '<?= \yii\helpers\Url::to(['/product/shipping-set-default'])?>';        $.post(url,{id:id}, function(result){            if(result.status == 'success'){                swal({                    title: result.message,                    text: result.message,                    type: result.status,                    timer: 1000                });                setTimeout(function () {                    initShipping();                },1500);            }        });        return false;    });    function initShippingAll(){        let url = '<?= \yii\helpers\Url::to(['/product/shipping-all'])?>';        $.get(url, function (result) {            $("#shipping").html(result);        });    }    $(".btn-shipping-create").on('click', function () {        let url = '<?= \yii\helpers\Url::to(['/product/shipping-create'])?>';        modalShipping(url);        return false;    });    $(".btn-shipping-delete").on('click', function () {        let url = '<?= \yii\helpers\Url::to(['/product/shipping-delete'])?>';        let id = $(this).attr('data-id');        bootbox.confirm({            message: "คุณแน่ใจว่าต้องการลบหรือไม่?",            buttons: {                confirm: {                    label: '<i class="fa fa-check"></i> ใช่',                    className: 'btn-success'                },                cancel: {                    label: '<i class="fa fa-times"></i> ไม่',                    className: 'btn-default'                }            },            callback: function (result) {                if(result === true){                    $.post(url,{id:id}).done(function(result) {                        if(result.status == 'success') {                            swal({                                title: result.message,                                text: result.message,                                type: result.status,                                timer: 2000                            });                            setTimeout(function () {                                initShippingAll();                            },500);                        } else {                            swal({                                title: result.message,                                text: result.message,                                type: result.status,                                timer: 2000                            });                        }                    }).fail(function() {                        <?= SDNoty::show("'" . SDHtml::getMsgError() . "Server Error'", '"error"')?>                        console.log('server error');                    });                }            }        });        return false;    });    $(".btn-shipping-update").on('click', function () {        let url = $(this).attr('href');        modalShipping(url);        return false;    });    function modalShipping(url) {        $('#modal-shippings .modal-content').html('<div class=\"sdloader \"><i class=\"sdloader-icon\"></i></div>');        $('#modal-shippings').modal('show')            .find('.modal-content')            .load(url);    }    function initShipping(){        let url = '<?= \yii\helpers\Url::to(['/product/shipping'])?>';        $.get(url, function (result) {            $("#shipping").html(result);        });    }    $(".btn-cancel").on('click', function () {        initShipping()    });    $('form#<?= $model->formName()?>').on('beforeSubmit', function(e) {        var $form = $(this);        $.post(            $form.attr('action'), //serialize Yii2 form            $form.serialize()        ).done(function(result) {            if(result.status == 'success'){                swal({                    title: result.message,                    text: result.message,                    type: result.status,                    timer: 2000                });            }        }).fail(function() {            <?= SDNoty::show("'" . SDHtml::getMsgError() . "Server Error'", '"error"')?>            console.log('server error');        });        return false;    });</script><?php  \richardfan\widget\JSRegister::end(); ?>